(this.webpackJsonptoday=this.webpackJsonptoday||[]).push([[0],{106:function(e,t,a){e.exports=a(386)},113:function(e,t,a){},114:function(e,t,a){},116:function(e,t,a){},156:function(e,t,a){},386:function(e,t,a){"use strict";a.r(t);var n=a(4),o=a.n(n),i=a(7),r=a(0),c=a.n(r),l=a(10),s=a.n(l),d=(a(112),a(113),a(8)),u=a(9),h=a(83),m=a.n(h),y=a(84),f=a.n(y),p=function(){function e(t,a){Object(d.a)(this,e),this._dateId=t,this._text=a.trim()}return Object(u.a)(e,[{key:"dateId",get:function(){return this._dateId}},{key:"text",get:function(){return this._text},set:function(e){this._text=e}},{key:"html",get:function(){return f.a.sanitize(m()(this._text))}}]),e}(),g=function(){function e(){Object(d.a)(this,e)}return Object(u.a)(e,null,[{key:"getIso8601z",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="date"in e?e.date:new Date,a="onlyDate"in e&&e.onlyDate,n="timeSeparator"in e?e.timeSeparator:":",o=!("withTimezone"in e)||e.withTimezone,i=t.getTimezoneOffset(),r=parseInt(Math.abs(i/60)),c=Math.abs(i%60),l=null;r<10&&(r="0".concat(r)),c<10&&(c="0".concat(c)),i<0?l="+".concat(r,":").concat(c):i>0?l="-".concat(r,":").concat(c):0===i&&(l="Z");var s=t.getDate(),d=t.getMonth()+1,u=t.getFullYear(),h=t.getHours(),m=t.getMinutes(),y=t.getSeconds(),f=null;return s=s<10?"0".concat(s):s,d=d<10?"0".concat(d):d,h=h<10?"0".concat(h):h,m=m<10?"0".concat(m):m,y=y<10?"0".concat(y):y,f="".concat(u,"-").concat(d,"-").concat(s,"T").concat(h).concat(n).concat(m).concat(n).concat(y),a?"".concat(u,"-").concat(d,"-").concat(s):o?"".concat(f).concat(l):f}},{key:"isItToday",value:function(t){return e.getIso8601z({onlyDate:!0})===t.slice(0,10)}},{key:"dayDeltaFromToday",value:function(t){var a=new Date(e.getIso8601z({onlyDate:!0}));return(new Date(t)-a)/864e5}},{key:"getDayRelativeTo",value:function(t,a){var n=new Date(t);return n.setDate(n.getDate()+a),e.getIso8601z({date:n,onlyDate:!0})}},{key:"downloadJSON",value:function(e,t){var a=document.createElement("a");a.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(t)),a.setAttribute("download",e),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}}]),e}(),v=a(47),E=new(function(){function e(){Object(d.a)(this,e),this._collection={}}return Object(u.a)(e,[{key:"exportJsonSnapshot",value:function(){var e=this,t={};return Object.keys(this._collection).forEach((function(a){t[a]=e._collection[a].text})),JSON.stringify(t)}},{key:"downloadSnapshot",value:function(){var e=this.exportJsonSnapshot(),t="todatoday_snapshot_".concat(g.getIso8601z({timeSeparator:"-",withTimezone:!1}),".json");g.downloadJSON(t,e)}},{key:"load",value:function(){var e=Object(i.a)(o.a.mark((function e(){var t,a,n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get("today_dateIdList",null);case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return");case 5:t=JSON.parse(t),a=0;case 7:if(!(a<t.length)){e.next=16;break}return n=t[a],e.next=11,v.a.get(t[a]);case 11:i=e.sent,this.setEntry(n,i);case 13:a+=1,e.next=7;break;case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateImmortalIndex",value:function(){var e=Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.set("today_dateIdList",JSON.stringify(Object.keys(this._collection)));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setEntry",value:function(e,t){var a=t.trim();if(0!==a.length){var n=!1;e in this._collection||(n=!0),this._collection[e]=new p(e,a),v.a.set(e,a),n&&this.updateImmortalIndex()}else this.deleteEntry(e)}},{key:"getEntry",value:function(e){return e in this._collection?this._collection[e]:null}},{key:"hasEntry",value:function(e){return e in this._collection}},{key:"deleteEntry",value:function(e){e in this._collection&&(delete this._collection[e],v.a.remove(e).then((function(e){return console.log(e)})).catch((function(e){return console.log("err",e)}))),this.updateImmortalIndex()}}]),e}()),D=a(28),b=a(27),k=(a(114),a(393)),w=a(388),x=a(394),S=a(395),O=a(392),_=a(400),j=a(387),I=a(389),T=a(396),M=new(a(101).a);M.set("selectedDate",g.getIso8601z({onlyDate:!0}));var C=M,z=a(99),N=(a(115),a(116),function(e){Object(D.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).dlSnapshot=function(){E.downloadSnapshot()},n.state={},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"side-panel"},c.a.createElement(z.a,{className:"calendar",onChange:function(t){console.log(t),C.set("selectedDate",g.getIso8601z({date:t,onlyDate:!0})),e.props.hideDrawer()}}),c.a.createElement(j.a,null),c.a.createElement(I.a,{className:"wide-button",type:"primary",icon:c.a.createElement(T.a,null),size:"large",onClick:this.dlSnapshot},"Export snapshot"))}}]),a}(c.a.Component)),R=a(391),A=a(390),J=a(65),L=a(397),H=a(398),F=a(399),K=(a(156),a(87)),U=a.n(K),V=(a(365),function(e){Object(D.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).highlight=function(){!n.state.editionMode&&n._htmlDivRef.current&&n._htmlDivRef.current.querySelectorAll("pre").forEach((function(e){console.log("node",e),U.a.highlightBlock(e)}))},n.onTextUpdate=function(e,t){n._editText=t},n.textSave=function(){E.setEntry(n.state.selectedDate,n._editText),n.setState({editionMode:!1})},n.goEdit=function(){n.setState({editionMode:!0}),R.a.info({message:"Tips",description:"Press Escape key to save!",placement:"bottomRight"})},n.previousDay=function(e){e.preventDefault(),C.set("selectedDate",g.getDayRelativeTo(n.state.selectedDate,-1))},n.nextDay=function(e){e.preventDefault(),C.set("selectedDate",g.getDayRelativeTo(n.state.selectedDate,1))},n.handleEditorDidMount=function(e,t){n.editor=t,n.setState({isEditorReady:!0})},n.state={selectedDate:C.get("selectedDate"),editionMode:!1,isEditorReady:!1},n._htmlDivRef=c.a.createRef(),n._editText="",n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keyup",(function(t){e.state.editionMode&&"Escape"===t.key&&e.textSave(),e.state.editionMode||"Enter"!==t.key||e.goEdit(),"ArrowLeft"===t.key&&e.previousDay(t),"ArrowRight"===t.key&&e.nextDay(t),console.log(t)})),C.on("set:selectedDate",(function(t){e.setState({selectedDate:t.value})})),this.highlight()}},{key:"componentDidUpdate",value:function(){this.state.editionMode,this.highlight()}},{key:"render",value:function(){var e=this.state.selectedDate,t=E.getEntry(e);this._editText=t?t.text:"";var a=t?t.html:"",n=new Date(e).toDateString(),o=null;if(g.isItToday(e))o=c.a.createElement("div",{className:"date-title"},c.a.createElement("div",{style:{fontSize:"2em"}},"Today"),c.a.createElement("div",{style:{marginLeft:5,color:"#aaa"}},n));else{var i=g.dayDeltaFromToday(e),r=Math.abs(i),l=i<0?"".concat(r," days ago"):"in ".concat(r," day").concat(r>1?"s":""," from now");o=c.a.createElement("div",{className:"date-title"},c.a.createElement("div",{style:{fontSize:"2em"}},n),c.a.createElement("div",{style:{marginLeft:5,color:"#aaa"}},l))}var s=c.a.createElement(x.a,{align:"middle"},c.a.createElement(S.a,{span:6,style:{textAlign:"right"}},c.a.createElement(A.a,{placement:"left",title:"Keyboard left key \u26a1"},c.a.createElement(L.a,{className:"arrow-day",onClick:this.previousDay}))),c.a.createElement(S.a,{span:12},o),c.a.createElement(S.a,{span:6,style:{textAlign:"left"}},c.a.createElement(A.a,{placement:"right",title:"Keyboard right key \u26a1"},c.a.createElement(H.a,{className:"arrow-day",onClick:this.nextDay})))),d=null,u=null;return this.state.editionMode?(console.log("EDIT MODE"),u=c.a.createElement(x.a,{justify:"center"},c.a.createElement(I.a,{type:"primary",onClick:this.textSave},"Save")),d=c.a.createElement("div",{className:"editor-container"},c.a.createElement(J.ControlledEditor,{className:"monaco-editor",language:"markdown",theme:"light",options:{fontSize:16,wordWrap:"on",minimap:{enabled:!1},scrollbar:{useShadows:!1},renderLineHighlight:"none",lineNumbersMinChars:3,autoClosingQuotes:"always"},value:this._editText,editorDidMount:this.handleEditorDidMount,onChange:this.onTextUpdate}))):(console.log("READ MODE"),u=c.a.createElement(x.a,{justify:"center"},c.a.createElement(I.a,{type:"primary",onClick:this.goEdit},"Edit")),d=c.a.createElement("div",null,c.a.createElement(j.a,null),c.a.createElement(A.a,{placement:"left",title:"Double click to edit \u26a1",destroyTooltipOnHide:!0},c.a.createElement("div",{ref:this._htmlDivRef,dangerouslySetInnerHTML:{__html:a},onDoubleClick:this.goEdit})),c.a.createElement(j.a,null))),null!==t||this.state.editionMode||(u=null,d=c.a.createElement("div",{style:{height:"50vh",position:"relative"}},c.a.createElement("div",{style:{position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",width:"fit-content",height:"fit-content",textAlign:"center",border:"dashed 1px #8ac7ff",padding:20}},c.a.createElement("div",{style:{}},c.a.createElement("div",null,c.a.createElement(F.a,{style:{fontSize:50,color:"#8ac7ff"}})),c.a.createElement("div",{style:{margin:20}},"Nothing yet, let's write something!"),c.a.createElement("div",null,c.a.createElement(I.a,{type:"primary",onClick:this.goEdit},"Write")))))),c.a.createElement("div",{className:"central-display"},s,d,u)}}]),a}(c.a.Component)),W=k.a.Header,B=(k.a.Footer,k.a.Sider,k.a.Content);document.addEventListener("keydown",(function(e){(window.navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&83==e.keyCode&&(e.preventDefault(),E.downloadSnapshot())}),!1);var q=function(e){Object(D.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).showDrawer=function(){n.setState({drawerVisible:!0})},n.hideDrawer=function(){n.setState({drawerVisible:!1})},n.backOnToday=function(){C.set("selectedDate",g.getIso8601z({onlyDate:!0}))},n.state={drawerVisible:!1},n}return Object(u.a)(a,[{key:"render",value:function(){var e=c.a.createElement("span",{className:"today-logo"},c.a.createElement("span",{style:{fontWeight:600,marginRight:"0.25em"}},"today"),c.a.createElement("span",{style:{fontWeight:300}},"today")),t=c.a.createElement("span",null,"Made by ",c.a.createElement("a",{href:"https://twitter.com/jonathanlurie"},"@jonathanlurie"),". Fork it on ",c.a.createElement("a",{href:"https://github.com/jonathanlurie/todaytoday"},"GitHub"),".");return c.a.createElement(k.a,{style:{background:"#fff"}},c.a.createElement(W,{style:{background:"white"}},c.a.createElement(w.a,{size:"middle"},c.a.createElement(_.a,{onClick:this.showDrawer}),c.a.createElement("div",{onClick:this.backOnToday},e))),c.a.createElement(x.a,null,c.a.createElement(S.a,{xs:2,sm:2,md:4,lg:4,xl:6}),c.a.createElement(S.a,{xs:20,sm:20,md:16,lg:16,xl:12},c.a.createElement(B,null,c.a.createElement(V,null))),c.a.createElement(S.a,{xs:2,sm:2,md:4,lg:4,xl:6})),c.a.createElement(O.a,{title:e,placement:"left",closable:!1,onClose:this.hideDrawer,visible:this.state.drawerVisible,width:350,footer:t},c.a.createElement(N,{hideDrawer:this.hideDrawer})))}}]),a}(c.a.Component);Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.load();case 2:s.a.render(c.a.createElement(q,null),document.getElementById("root"));case 3:case"end":return e.stop()}}),e)})))()}},[[106,1,2]]]);
//# sourceMappingURL=main.e8ed82d4.chunk.js.map